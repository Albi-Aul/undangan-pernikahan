<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Undangan Pernikahan Albi & Aul</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

  <!-- Open Graph (thumbnail untuk WhatsApp / chat preview) -->
  <meta property="og:title" content="Undangan Pernikahan Albi & Aul ðŸ’" />
  <meta property="og:description" content="Dengan penuh cinta kami mengundang Anda untuk hadir di hari bahagia kami. Klik untuk membuka undangan." />
  <meta property="og:image" content="https://albi-aul.github.io/undangan-pernikahan/cover.jpg" />
  <meta property="og:url" content="https://albi-aul.github.io/undangan-pernikahan/" />
  <meta property="og:type" content="website" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta name="twitter:card" content="summary_large_image" />

  <style>
    :root{
      --accent:#2f8f6f;
      --accent-dark:#265f4f;
      --white:#ffffff;
      --muted:#6b6b6b;
      --glass: rgba(255,255,255,0.18);
      --round:16px;
      font-family: "Poppins", system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;background:#fff;color:#111;-webkit-font-smoothing:antialiased}
    button{font-family:inherit}

    /* COVER */
    .cover{
      position:fixed;inset:0;
      background: center/cover no-repeat url('cover.jpg');
      display:flex;flex-direction:column;align-items:center;justify-content:center;
      text-align:center;padding:28px;
      background-color:rgba(0,0,0,0.35);background-blend-mode:overlay;
      transition:opacity .6s ease;
      color:var(--white);
    }
    .cover h1{font-family:'Great Vibes',cursive;font-size:3.2rem;margin:0 0 6px;text-shadow:0 3px 12px rgba(0,0,0,.55)}
    .cover h2{font-size:1.1rem;margin:0 0 8px;text-transform:none;letter-spacing:1px;text-shadow:0 2px 8px rgba(0,0,0,.45)}
    #guestName {
      margin-top:8px;margin-bottom:14px;font-size:1.02rem;font-style:italic;color:var(--white);
      text-shadow:0 2px 10px rgba(0,0,0,.7);
    }
    #countdown {
      display:inline-block;padding:8px 18px;border-radius:999px;background:rgba(255,255,255,0.14);
      backdrop-filter: blur(6px); color:var(--white);font-weight:600;margin-bottom:18px;box-shadow:0 6px 20px rgba(0,0,0,.25)
    }
    .cover .btn {
      margin:8px 6px;padding:10px 24px;border-radius:999px;border:2px solid rgba(255,255,255,.98);
      background:transparent;color:var(--white);font-weight:700;cursor:pointer;min-width:160px;
      transition:all .28s ease;
    }
    .cover .btn:hover{background:var(--white);color:var(--accent)}

    /* VIDEO PAGE */
    .video-page{
      position:fixed;inset:0;display:none;align-items:center;justify-content:center;flex-direction:column;background:#000;padding:20px;
    }
    .video-frame{
      width:min(1100px,92%);max-height:82vh;border-radius:18px;overflow:hidden;
      box-shadow:0 18px 48px rgba(0,0,0,.45);background:#000;padding:6px;
      display:flex;align-items:center;justify-content:center;
    }
    video#weddingVideo{
      width:100%;height:auto;display:block;border-radius:12px;object-fit:contain;background:#000;
    }
    .video-controls{
      margin-top:14px;display:flex;gap:12px;align-items:center;justify-content:center;
    }
    .video-controls button{
      padding:10px 18px;border-radius:999px;border:none;background:var(--accent);color:#fff;font-weight:700;cursor:pointer;
      min-width:110px;
    }
    .video-controls button.secondary{background:transparent;color:var(--accent);border:2px solid var(--accent)}

    /* THANKS PAGE */
    .thanks-page{
      position:fixed;inset:0;display:none;align-items:center;justify-content:center;padding:28px;
      background: center/cover no-repeat url('prewed2.jpeg');
      background-blend-mode:overlay;background-color:rgba(255,255,255,0.75);backdrop-filter:blur(8px);
      text-align:center;color:var(--accent-dark);
    }
    .thanks-inner{max-width:920px;padding:22px;border-radius:14px;background:linear-gradient(180deg, rgba(255,255,255,0.85), rgba(245,255,250,0.75));box-shadow:0 12px 40px rgba(16,35,22,0.06)}
    .thanks-inner h1{font-family:'Great Vibes',cursive;font-size:3rem;margin:6px 0 6px;color:var(--accent-dark)}
    .thanks-inner p{font-size:1.05rem;color:#2b3a37;margin:10px 0 18px}
    .kado{font-weight:700;margin-bottom:8px;color:#245b4b}
    .dana-container{display:flex;flex-direction:column;align-items:center;gap:10px;margin-bottom:18px}
    .dana-container img{width:140px;height:auto;display:block}
    .copy-btn{padding:10px 20px;border-radius:999px;border:none;background:var(--accent);color:#fff;font-weight:700;cursor:pointer}
    .maps-btn{padding:10px 20px;border-radius:999px;border:2px solid var(--accent);background:transparent;color:var(--accent);font-weight:700;text-decoration:none}
    .names{font-family:'Great Vibes',cursive;font-size:1.5rem;margin-top:18px;color:var(--accent-dark)}

    /* responsive */
    @media (max-width:720px){
      .cover h1{font-size:2.4rem}
      .thanks-inner{padding:18px}
      .dana-container img{width:110px}
      .video-frame{max-height:70vh}
    }
  </style>
</head>
<body>

  <!-- COVER -->
  <main class="cover" id="cover">
    <h1>Albi &amp; Aul</h1>
    <h2>Undangan Resepsi Pernikahan</h2>

    <!-- Guest name (Kepada yang terhormat: Nama) placed below title -->
    <div id="guestName" aria-live="polite"></div>

    <!-- Minimal countdown with blur glass -->
    <div id="countdown" role="status" aria-live="polite"></div>

    <div style="margin-top:18px;">
      <button class="btn" id="openBtn" aria-label="Buka undangan">Buka Undangan</button>
      <button class="btn" id="shareBtn" aria-label="Bagikan ke WhatsApp">Bagikan ke WhatsApp</button>
    </div>
  </main>

  <!-- VIDEO PAGE -->
  <section class="video-page" id="videoPage" aria-hidden="true">
    <div class="video-frame" role="region" aria-label="Video undangan">
      <video id="weddingVideo" src="video.mp4" playsinline webkit-playsinline preload="metadata"></video>
    </div>

    <div class="video-controls" role="toolbar" aria-label="Kontrol video">
      <button id="playPauseBtn" aria-pressed="false">Pause</button>
      <button id="skipBtn" class="secondary" aria-label="Lewati video">Lewati</button>
    </div>
  </section>

  <!-- THANK YOU PAGE -->
  <section class="thanks-page" id="thanksPage" aria-hidden="true">
    <div class="thanks-inner" role="region" aria-label="Ucapan terima kasih">
      <h1>Terima Kasih</h1>
      <p>Dengan penuh rasa syukur, kami mengucapkan terima kasih atas doa dan kehadiran yang berarti bagi kami.</p>

      <div class="kado">Kado Digital ðŸ’™</div>
      <div class="dana-container" role="group" aria-label="Kado Dana">
        <img src="dana.png" alt="Logo DANA" id="danaLogo">
        <button class="copy-btn" id="copyDanaBtn" aria-label="Salin nomor DANA">Salin Nomor DANA</button>
      </div>

      <a class="maps-btn" id="mapsBtn" href="https://maps.app.goo.gl/Rt4eNJmURrbSWSZv7" target="_blank" rel="noopener">Buka Maps</a>

      <div class="names" aria-hidden="false">Albi &amp; Aul</div>
    </div>
  </section>

  <!-- Background audio (will be started by user gesture) -->
  <audio id="bgMusic" src="musik.mp3" preload="auto"></audio>

  <script>
    /* Config */
    const SHARE_LINK = "https://albi-aul.github.io/undangan-pernikahan/";
    // WhatsApp share text (without date) â€” user approved version
    const WHATSAPP_TEXT =
`ðŸ’Œ Undangan Pernikahan Albi & Aul ðŸ’
Dengan penuh cinta dan rasa syukur, kami mengundang Bapak/Ibu/Saudara/i untuk hadir di hari bahagia kami.

ðŸ“ Cek lokasi lengkap dan detail acara di undangan digital kami:
${SHARE_LINK}

Kehadiran dan doa restu Anda merupakan hadiah terindah bagi kami.
â€” Albi & Aul`;

    const DANA_NUMBER = "088291195336"; // kept hidden, copied via button

    /* DOM */
    const cover = document.getElementById('cover');
    const openBtn = document.getElementById('openBtn');
    const shareBtn = document.getElementById('shareBtn');
    const guestNameEl = document.getElementById('guestName');
    const countdownEl = document.getElementById('countdown');

    const videoPage = document.getElementById('videoPage');
    const video = document.getElementById('weddingVideo');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const skipBtn = document.getElementById('skipBtn');

    const thanksPage = document.getElementById('thanksPage');
    const bgMusic = document.getElementById('bgMusic');
    const copyDanaBtn = document.getElementById('copyDanaBtn');

    /* Helper â€” get name from ?to= query param */
    const params = new URLSearchParams(window.location.search);
    const guestParam = params.get('to') || params.get('nama') || params.get('name') || "";
    if(guestParam){
      // decode and show with colon as requested
      const decoded = decodeURIComponent(guestParam).replace(/\+/g,' ');
      guestNameEl.textContent = `Kepada yang terhormat: ${decoded}`;
    } else {
      // if no name, hide the element visually (keep for layout)
      guestNameEl.textContent = "";
    }

    /* Minimal countdown (days hours minutes) */
    const target = new Date("2025-11-15T07:00:00"); // UTC offset local assumed
    function updateCountdown(){
      const now = new Date();
      let diff = Math.max(0, target - now);
      const days = Math.floor(diff / (1000*60*60*24));
      diff -= days * (1000*60*60*24);
      const hours = Math.floor(diff / (1000*60*60));
      diff -= hours * (1000*60*60);
      const minutes = Math.floor(diff / (1000*60));
      countdownEl.textContent = `${days} hari ${hours} jam ${minutes} menit lagi`;
    }
    updateCountdown();
    setInterval(updateCountdown, 60*1000);

    /* Transition helpers */
    function showVideoPage(){
      // hide cover, show video page
      cover.style.opacity = "0";
      setTimeout(() => {
        cover.style.display = "none";
        videoPage.style.display = "flex";
        videoPage.style.opacity = "1";
      }, 500);
    }
    function showThanksPage(){
      videoPage.style.opacity = "0";
      setTimeout(() => {
        videoPage.style.display = "none";
        thanksPage.style.display = "flex";
        thanksPage.style.opacity = "1";
      }, 600);
    }

    /* OPEN â€” start music & video together on user gesture */
    openBtn.addEventListener('click', async () => {
      try {
        // start music first (user gesture)
        await bgMusic.play();
      } catch(e){
        // some browsers may still block audio â€” but we'll attempt video play below
        console.warn('bgMusic play blocked', e);
      }
      // show video UI
      showVideoPage();
      // try to play video; if gesture allowed, will play with sound off or with bgMusic playing
      try {
        await video.play();
      } catch(err){
        console.warn('video play blocked', err);
      }
    });

    /* SHARE to WhatsApp (cover button) */
    shareBtn.addEventListener('click', () => {
      const text = WHATSAPP_TEXT;
      const url = "https://wa.me/?text=" + encodeURIComponent(text);
      window.open(url, "_blank");
    });

    /* Play/Pause sync â€” video and bgMusic follow each other */
    playPauseBtn.addEventListener('click', async () => {
      if (video.paused) {
        try{ await video.play(); } catch(e){ console.warn('video play blocked', e); }
        try{ await bgMusic.play(); } catch(e){ console.warn('bgMusic play blocked', e); }
        playPauseBtn.textContent = 'Pause';
        playPauseBtn.setAttribute('aria-pressed','true');
      } else {
        video.pause();
        bgMusic.pause();
        playPauseBtn.textContent = 'Play';
        playPauseBtn.setAttribute('aria-pressed','false');
      }
    });

    /* When video plays/pauses by other means, keep music in sync */
    video.addEventListener('play', () => {
      // ensure bgMusic is playing
      if (bgMusic.paused) {
        bgMusic.play().catch(()=>{});
      }
      playPauseBtn.textContent = 'Pause';
      playPauseBtn.setAttribute('aria-pressed','true');
    });
    video.addEventListener('pause', () => {
      if (!bgMusic.paused) {
        bgMusic.pause();
      }
      playPauseBtn.textContent = 'Play';
      playPauseBtn.setAttribute('aria-pressed','false');
    });

    /* Skip button â€” stop video and go to thanks; music continues */
    skipBtn.addEventListener('click', () => {
      // stop video & navigate to thanks
      try{ video.pause(); video.currentTime = video.duration || 0; } catch(e){ }
      showThanksPage();
      // music should keep playing (per requirements)
    });

    /* When video ends, show thanks page (music keeps playing) */
    video.addEventListener('ended', () => {
      showThanksPage();
    });

    /* Copy DANA number â€” number hidden, only copied via button */
    copyDanaBtn.addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(DANA_NUMBER);
        copyDanaBtn.textContent = 'Nomor Disalin âœ…';
        setTimeout(()=>{ copyDanaBtn.textContent = 'Salin Nomor DANA'; }, 2200);
      } catch (err) {
        // fallback: create textarea
        const ta = document.createElement('textarea');
        ta.value = DANA_NUMBER;
        document.body.appendChild(ta);
        ta.select();
        try {
          document.execCommand('copy');
          copyDanaBtn.textContent = 'Nomor Disalin âœ…';
          setTimeout(()=>{ copyDanaBtn.textContent = 'Salin Nomor DANA'; }, 2200);
        } catch(e){
          alert('Salin manual: ' + DANA_NUMBER);
        }
        ta.remove();
      }
    });

    /* Accessibility: allow Space to toggle play/pause when video page visible */
    document.addEventListener('keydown', (ev) => {
      if (ev.key === ' ' && videoPage.style.display === 'flex') {
        ev.preventDefault();
        if (video.paused) {
          video.play().catch(()=>{});
          bgMusic.play().catch(()=>{});
        } else {
          video.pause();
          bgMusic.pause();
        }
      }
    });

    /* Safety: ensure pages initial state */
    (function initState(){
      cover.style.display = 'flex';
      videoPage.style.display = 'none';
      thanksPage.style.display = 'none';
    })();
  </script>
</body>
</html>
